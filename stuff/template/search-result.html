<head>
  <style>
  body {font-family:sans-serif;}
  td {
	  vertical-align:top;
  }
  .searchfield {
	  background-color:#eeeeee;
	  horizontal-align: center;
	  padding: 10px;
  }
  .rbox {
	  border-width: 1px;
	  border-style: solid;
	  border-color: #cccccc;
	  width: 240;   /* 172 + 2*margin */
	  height: 190;
	  float: left;
	  padding: 5px 5px;
	  visibility:hidden;
  }
  .rimg {
	  padding-left:34px;
  }
  </style>
  <script>
  function retrieve(input_field) {
	  xmlhttp=new XMLHttpRequest();
	  xmlhttp.onreadystatechange = function() {
		  j = JSON.parse(xmlhttp.responseText);
		  filltab(j);
	  };
	  url="/api?q=" + input_field.value;
	  xmlhttp.open("GET", url, true);
	  xmlhttp.send();
  }
  </script>
</head>
<div><a href="/form">[Input]</a>&nbsp;[Search] <span style="font-size:smaller;">(experimental)</span></div>

<div class="searchfield"><input type="text" size="80" onkeyup="retrieve(this);"></div>
&nbsp;
<div id="result-list">
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
  <div class="rbox"><img src="#" class="rimg"><div style="3em">Hello<br/>world</div></div>
</div>
<script>
var fallback = "http://localhost:3000/static/fallback.jpg";
var references = [];
var result_items = document.getElementById('result-list').childNodes;
for (var r = 0; r < result_items.length; ++r) {
	var x = result_items[r];
	if (x.nodeName != "DIV") continue
	var img = x.childNodes[0];
	img.height=128;
	img.width=172;
	references.push({ obj: x, img: x.childNodes[0], txt: x.childNodes[1]});
}

function filltab(data) {
	var len = data.length < references.length ? data.length : references.length
	console.log(data.length);
	var i = 0;
	for (i = 0; i < len; ++i) {
		var d = data[i];
		references[i].obj.style.visibility = 'visible';
		references[i].img.src = "/img/" + d.id + ".jpg";
		references[i].txt.innerHTML = d.txt;
	}
	for (; i < references.length; ++i) {
		references[i].obj.style.visibility = 'hidden';
	}
}
</script>
</body>
